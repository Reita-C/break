#include "DxLib.h"
#define mybox_Ly 430
#define mybox_Ry 440


void ball(void);
void mybox(void);
void atari(void);
void mykey_R(void);
void mykey_L(void);
void speedkey_R(void);
void speedkey_L(void);
void brock(void);
void brock1(void);
void brock2(void);
void brock3(void);
void brock4(void);
void brock5(void);
void brock6(void);
void brock7(void);
void brock8(void);
void brock9(void);
void brock10(void);
void brock11(void);
void brock12(void);
void brock13(void);
void brock14(void);
void brock15(void);
void movebrock(void);

int all_get_key(void);

int in0 = 0;
int in = 0;
int in1 = 0;
int in2 = 0;
int in3 = 0;
int in4 = 0;
int in5 = 0;
int in6 = 0;
int in7 = 0;
int in8 = 0;
int in9 = 0;
int in10 = 0;
int in11 = 0;
int in12 = 0;
int in13 = 0;
int in14 = 0;
int in15 = 0;
int key[256];
int gamecount;
int ball_x = 0;
int ball_y = 430;
int x_houkou = 0;
int y_houkou = 0;
int mybox_Lx = 0;
int mybox_Rx = 60;
int move;
int a = 0;
double ballspeed = 3;
double kakudo = 0;
int x_boxhoukou = 0;
int y_boxhoukou = 0;


int Color_White = GetColor(255, 255, 255);


int WINAPI WinMain(HINSTANCE, HINSTANCE, LPSTR, int) {

	ChangeWindowMode(TRUE);
	DxLib_Init();
	SetDrawScreen(DX_SCREEN_BACK);

	while (ScreenFlip() == 0 && ProcessMessage() == 0
		&& ClearDrawScreen() == 0 && all_get_key() == 0 && CheckHitKey(KEY_INPUT_I) == 0) {

		brock();
		brock1();
		brock2();
		brock3();
		brock4();
		brock5();
		brock6();
		brock7();
		brock8();
		brock9();
		brock10();
		brock11();
		brock12();
		brock13();
		brock14();
		brock15();
		movebrock();
		mybox();
		mykey_R();
		speedkey_R();
		mykey_L();
		speedkey_L();

	}


	while (ScreenFlip() == 0 && ProcessMessage() == 0
		&& ClearDrawScreen() == 0 && all_get_key() == 0 && ball_y < 480) {


		ballspeed += 0.001;

		mybox();
		mykey_R();
		speedkey_R();
		mykey_L();
		speedkey_L();
		brock();
		brock1();
		brock2();
		brock3();
		brock4();
		brock5();
		brock6();
		brock7();
		brock8();
		brock9();
		brock10();
		brock11();
		brock12();
		brock13();
		brock14();
		brock15();
		movebrock();
		atari();
		ball();

	}
	WaitKey();
	DxLib_End();
	return 0;
}

void mybox(void) {
		
	DrawBox(mybox_Lx + move, mybox_Ly, mybox_Rx + move, mybox_Ry, GetColor(0, 255, 0), TRUE);

}

void ball(void) {

	DrawCircle(ball_x, ball_y, 3, GetColor(255, 0, 0));

	if (x_houkou == 0) {
		ball_x = ball_x + ballspeed + kakudo;
	}
	else {
		ball_x = ball_x - ballspeed - kakudo;
	}
	
	if (y_houkou == 0) {
		ball_y = ball_y - ballspeed;
	}

	else {
		ball_y = ball_y + ballspeed;
	}
	
	if (ball_x >= 640) {
		x_houkou = 1;
	}

	if (ball_x <= 0) {
		x_houkou = 0;
	}

	if (ball_y >= 480) {
		y_houkou = 0;
	}

	if (ball_y <= 0) {
		y_houkou = 1;
	}
}

void atari(void) {

	if (ball_x <= mybox_Rx + move && ball_x >= mybox_Lx + move && ball_y >= mybox_Ly && ball_y <= mybox_Ry && CheckHitKey(KEY_INPUT_G) > 0 && x_houkou == 0) {
		y_houkou = 0;
		kakudo -= 0.7;
	}
	else if (ball_x <= mybox_Rx + move && ball_x >= mybox_Lx + move && ball_y >= mybox_Ly && ball_y <= mybox_Ry && CheckHitKey(KEY_INPUT_G) > 0 && x_houkou == 1) {
		y_houkou = 0;
		kakudo += 0.7;
	}
	else if (ball_x <= mybox_Rx + move && ball_x >= mybox_Lx + move && ball_y >= mybox_Ly && ball_y <= mybox_Ry && CheckHitKey(KEY_INPUT_H) > 0 && x_houkou == 0) {
		y_houkou = 0;
		kakudo += 0.7;
	}
	else if (ball_x <= mybox_Rx + move && ball_x >= mybox_Lx + move && ball_y >= mybox_Ly && ball_y <= mybox_Ry && CheckHitKey(KEY_INPUT_H) > 0 && x_houkou == 1) {
		y_houkou = 0;
		kakudo -= 0.7;
	}
	else if (ball_x <= mybox_Rx + move && ball_x >= mybox_Lx + move && ball_y >= mybox_Ly && ball_y <= mybox_Ry) {
		y_houkou= 0;
	}
}

void mykey_R(void) {

	if ((mybox_Rx + move) <= 640) {
		if (CheckHitKey(KEY_INPUT_J) > 0) {
			//jを押されたら右に動く
			move += 5;
		}
	}
}

void speedkey_R(void) {

	if ((mybox_Rx + move) <= 640) {
		if (CheckHitKey(KEY_INPUT_K) > 0) {
			//jを押されたら右に動く
			move += 10;
		}
	}
}

void mykey_L(void) {

	if ((mybox_Lx + move) >= 0) {
		if (CheckHitKey(KEY_INPUT_F) > 0) {
			//fを押されたら左に動く
			move -= 5;
		}
	}
}

void speedkey_L(void) {

	if ((mybox_Lx + move) >= 0) {
		if (CheckHitKey(KEY_INPUT_D) > 0) {
			//fを押されたら左に動く
			move -= 10;
		}
	}
}

void brock(void) {

	if (ball_x >= 0 && ball_x <= 79 && ball_y <= 5 && y_houkou == 0 && in == 0) {
		y_houkou = 1;
		DrawBox(0, 0, 79, 5, GetColor(255, 0, 0), TRUE);
		in++;
	}
	else if (ball_x >= 0 && ball_x <= 79 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in == 0) {
		y_houkou = 0;
		DrawBox(0, 0, 79, 5, GetColor(255, 0, 0), TRUE);
		in++;
	}
	else if (in == 0) {
		DrawBox(0, 0, 79, 5, GetColor(255, 0, 0), TRUE);
	}
	else if (in >= 1) {
		DrawBox(0, 0, 79, 5, GetColor(0, 0, 0), TRUE);

	}
}

void brock1(void) {

	if (ball_x >= 81 && ball_x <= 159 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in1 == 0) {
		y_houkou = 1;
		DrawBox(81, 0, 159, 5, GetColor(0, 255, 0), TRUE);
		in1++;
	}
	else if (ball_x >= 81 && ball_x <= 159 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in1 == 0) {
		y_houkou = 0;
		DrawBox(81, 0, 159, 5, GetColor(0, 255, 0), TRUE);
		in1++;
	}
	else if (in1 == 0) {
		DrawBox(81, 0, 159, 5, GetColor(0, 255, 0), TRUE);
	}
	else if (in1 >= 1) {
		DrawBox(81, 0, 159, 5, GetColor(0, 0, 0), TRUE);
	}

}

void brock2(void) {

	if (ball_x >= 161 && ball_x <= 239 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in2 == 0) {
		y_houkou = 1;
		DrawBox(161, 0, 239, 5, GetColor(0, 0, 255), TRUE);
		in2++;
	}
	else if (ball_x >= 161 && ball_x <= 239 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in2 == 0) {
		y_houkou = 0;
		DrawBox(161, 0, 239, 5, GetColor(0, 0, 255), TRUE);
		in2++;
	}
	else if (in2 == 0) {
		DrawBox(161, 0, 239, 5, GetColor(0, 0, 255), TRUE);
	}
	else if (in2 >= 1) {
		DrawBox(161, 0, 239, 5, GetColor(0, 0, 0), TRUE);
	}
}

void brock3(void) {

	if (ball_x >= 241 && ball_x <= 319 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in3 == 0) {
		y_houkou = 1;
		DrawBox(241, 0, 319, 5, GetColor(255, 0, 0), TRUE);
		in3++;
	}
	else if (ball_x >= 241 && ball_x <= 319 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in3 == 0) {
		y_houkou = 0;
		DrawBox(241, 0, 319, 5, GetColor(255, 0, 0), TRUE);
		in3++;
	}
	else if (in3 == 0) {
		DrawBox(241, 0, 319, 5, GetColor(255, 0, 0), TRUE);
	}
	else if (in3 >= 1) {
		DrawBox(241, 0, 319, 5, GetColor(0, 0, 0), TRUE);
	}

}

void brock4(void) {

	if (ball_x >= 321 && ball_x <= 399 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in4 == 0) {
		y_houkou = 1;
		DrawBox(321, 0, 399, 5, GetColor(0, 255, 0), TRUE);
		in4++;
	}
	else if (ball_x >= 321 && ball_x <= 399 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in4 == 0) {
		y_houkou = 0;
		DrawBox(321, 0, 399, 5, GetColor(0, 255, 0), TRUE);
		in4++;
	}
	else if (in4 == 0) {
		DrawBox(321, 0, 399, 5, GetColor(0, 255, 0), TRUE);
	}
	else if (in4 >= 1) {
		DrawBox(321, 0, 399, 5, GetColor(0, 0, 0), TRUE);
	}
}

void brock5(void) {

	if (ball_x >= 401 && ball_x <= 479 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in5 == 0) {
		y_houkou = 1;
		DrawBox(401, 0, 479, 5, GetColor(0, 0, 255), TRUE);
		in5++;
	}
	else if (ball_x >= 401 && ball_x <= 479 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in5 == 0) {
		y_houkou = 0;
		DrawBox(401, 0, 479, 5, GetColor(0, 0, 255), TRUE);
		in5++;
	}
	else if (in5 == 0) {
		DrawBox(401, 0, 479, 5, GetColor(0, 0, 255), TRUE);
	}
	else if (in5 >= 1) {
		DrawBox(401, 0, 479, 5, GetColor(0, 0, 0), TRUE);
	}
}

void brock6(void) {

	if (ball_x >= 481 && ball_x <= 559 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in6 == 0) {
		y_houkou = 1;
		DrawBox(481, 0, 559, 5, GetColor(255, 0, 0), TRUE);
		in6++;
	}
	else if (ball_x >= 481 && ball_x <= 559 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in6 == 0) {
		y_houkou = 0;
		DrawBox(481, 0, 559, 5, GetColor(255, 0, 0), TRUE);
		in6++;
	}
	else if (in6 == 0) {
		DrawBox(481, 0, 559, 5, GetColor(255, 0, 0), TRUE);
	}
	else if (in6 >= 1) {
		DrawBox(481, 0, 559, 5, GetColor(0, 0, 0), TRUE);
	}
}

void brock7(void) {

	if (ball_x >= 561 && ball_x <= 680 && ball_y <= 5 && ball_y >= 0 && y_houkou == 0 && in7 == 0) {
		y_houkou = 1;
		DrawBox(561, 0, 680, 5, GetColor(0, 255, 0), TRUE);
		in7++;
	}
	else if (ball_x >= 561 && ball_x <= 680 && ball_y <= 5 && ball_y >= 0 && y_houkou == 1 && in7 == 0) {
		y_houkou = 0;
		DrawBox(561, 0, 680, 5, GetColor(0, 255, 0), TRUE);
		in7++;
	}
	else if (in7 == 0) {
		DrawBox(561, 0, 680, 5, GetColor(0, 255, 0), TRUE);
	}
	else if (in7 >= 1) {
		DrawBox(561, 0, 680, 5, GetColor(0, 0, 0), TRUE);
	}
}

void brock8(void) {

	if (ball_x >= 0 && ball_x <= 79 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in8 == 0) {
		y_houkou = 1;
		DrawBox(0, 6, 79, 10, GetColor(0, 255, 0), TRUE);
		in8++;
	}
	else if (ball_x >= 0 && ball_x <= 79 && ball_y <= 10 && ball_y >= 6 && y_houkou == 1 && in8 == 0) {
		y_houkou = 0;
		DrawBox(0, 6, 79, 10, GetColor(0, 255, 0), TRUE);
		in8++;
	}
	else if (in8 == 0) {
		DrawBox(0, 6, 79, 10, GetColor(0, 255, 0), TRUE);
	}
	else if (in8 >= 1) {
		DrawBox(0, 6, 79, 10, GetColor(0, 0, 0), TRUE);

	}
}

void brock9(void) {

	if (ball_x >= 81 && ball_x <= 159 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in9 == 0) {
		y_houkou = 1;
		DrawBox(81, 6, 159, 10, GetColor(0, 0, 255), TRUE);
		in9++;
	}
	else if (ball_x >= 81 && ball_x <= 159 && ball_y <= 10 && ball_y >= 0 && y_houkou == 1 && in9 == 0) {
		y_houkou = 0;
		DrawBox(81, 6, 159, 10, GetColor(0, 0, 255), TRUE);
		in9++;
	}
	else if (in9 == 0) {
		DrawBox(81, 6, 159, 10, GetColor(0, 0, 255), TRUE);
	}
	else if (in9 >= 1) {
		DrawBox(81, 6, 159, 10, GetColor(0, 0, 0), TRUE);
	}
}

void brock10(void) {

	if (ball_x >= 161 && ball_x <= 239 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in10 == 0) {
		y_houkou = 1;
		DrawBox(161, 6, 239, 10, GetColor(0, 0, 255), TRUE);
		in10++;
	}
	else if (ball_x >= 161 && ball_x <= 239 && ball_y <= 10 && ball_y >= 0 && y_houkou == 1 && in10 == 0) {
		y_houkou = 0;
		DrawBox(161, 6, 239, 10, GetColor(0, 0, 255), TRUE);
		in10++;
	}
	else if (in10 == 0) {
		DrawBox(161, 6, 239, 10, GetColor(0, 0, 255), TRUE);
	}
	else if (in10 >= 1) {
		DrawBox(161, 6, 239, 10, GetColor(0, 0, 0), TRUE);
	}
}

void brock11(void) {

	if (ball_x >= 241 && ball_x <= 319 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in11 == 0) {
		y_houkou = 1;
		DrawBox(241, 6, 319, 10, GetColor(255, 0, 0), TRUE);
		in11++;
	}
	else if (ball_x >= 241 && ball_x <= 319 && ball_y <= 10 && ball_y >= 6 && y_houkou == 1 && in11 == 0) {
		y_houkou = 0;
		DrawBox(241, 6, 319, 10, GetColor(255, 0, 0), TRUE);
		in11++;
	}
	else if (in11 == 0) {
		DrawBox(241, 6, 319, 10, GetColor(255, 0, 0), TRUE);
	}
	else if (in11 >= 1) {
		DrawBox(241, 6, 319, 10, GetColor(0, 0, 0), TRUE);
	}
}

void brock12(void) {

	if (ball_x >= 321 && ball_x <= 399 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in12 == 0) {
		y_houkou = 1;
		DrawBox(321, 6, 399, 10, GetColor(0, 255, 0), TRUE);
		in12++;
	}
	else if (ball_x >= 321 && ball_x <= 399 && ball_y <= 10 && ball_y >= 6 && y_houkou == 1 && in12 == 0) {
		y_houkou = 0;
		DrawBox(321, 6, 399, 10, GetColor(0, 255, 0), TRUE);
		in12++;
	}
	else if (in12 == 0) {
		DrawBox(321, 6, 399, 10, GetColor(0, 255, 0), TRUE);
	}
	else if (in12 >= 1) {
		DrawBox(321, 6, 399, 10, GetColor(0, 0, 0), TRUE);
	}
}

void brock13(void) {

	if (ball_x >= 401 && ball_x <= 479 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in13 == 0) {
		y_houkou = 1;
		DrawBox(401, 6, 479, 10, GetColor(0, 0, 255), TRUE);
		in13++;
	}
	else if (ball_x >= 401 && ball_x <= 479 && ball_y <= 10 && ball_y >= 6 && y_houkou == 1 && in13 == 0) {
		y_houkou = 0;
		DrawBox(401, 6, 479, 10, GetColor(0, 0, 255), TRUE);
		in13++;
	}
	else if (in13 == 0) {
		DrawBox(401, 6, 479, 10, GetColor(0, 0, 255), TRUE);
	}
	else if (in13 >= 1) {
		DrawBox(401, 6, 479, 15, GetColor(0, 0, 0), TRUE);
	}
}

void brock14(void) {

	if (ball_x >= 481 && ball_x <= 559 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in14 == 0) {
		y_houkou = 1;
		DrawBox(481, 6, 559, 10, GetColor(255, 0, 0), TRUE);
		in14++;
	}
	else if (ball_x >= 481 && ball_x <= 559 && ball_y <= 10 && ball_y >= 6 && y_houkou == 1 && in14 == 0) {
		y_houkou = 0;
		DrawBox(481, 6, 559, 10, GetColor(255, 0, 0), TRUE);
		in14++;
	}
	else if (in14 == 0) {
		DrawBox(481, 6, 559, 10, GetColor(255, 0, 0), TRUE);
	}
	else if (in14 >= 1) {
		DrawBox(481, 6, 559, 10, GetColor(0, 0, 0), TRUE);
	}
}

void brock15(void) {
	
	if (ball_x >= 561 && ball_x <= 680 && ball_y <= 10 && ball_y >= 6 && y_houkou == 0 && in15 == 0) {
		y_houkou = 1;
		DrawBox(561, 6, 680, 10, GetColor(0, 255, 0), TRUE);
		in15++;
	}
	else if (ball_x >= 561 && ball_x <= 680 && ball_y <= 10 && ball_y >= 6 && y_houkou == 1 && in15 == 0) {
		y_houkou = 0;
		DrawBox(561, 6, 680, 10, GetColor(0, 255, 0), TRUE);
		in15++;
	}
	else if (in15 == 0) {
		DrawBox(561, 6, 680, 10, GetColor(0, 255, 0), TRUE);
	}
	else if (in15 >= 1) {
		DrawBox(561, 6, 680, 10, GetColor(0, 0, 0), TRUE);
	}
}

void movebrock(void) {

	if (ball_x >= mybox_Lx + move && ball_x <= mybox_Rx + move && ball_y <= 20 && ball_y >= 16 && y_houkou == 0 && in0 == 0) {
		y_houkou = 1;
		DrawBox(mybox_Lx + move, 16, mybox_Rx + move, 20, GetColor(0, 255, 0), TRUE);
		in0++;
	}
	else if (ball_x >= mybox_Lx + move && ball_x <= mybox_Rx + move && ball_y <= 20 && ball_y >= 16 && y_houkou == 1 && in0 == 0) {
		y_houkou = 0;
		DrawBox(mybox_Lx + move, 16, mybox_Rx + move, 20, GetColor(0, 255, 0), TRUE);
		in0++;
	}
	else if (in0 == 0) {
		DrawBox(mybox_Lx + move, 16, mybox_Rx + move, 20, GetColor(0, 255, 0), TRUE);
	}
	else if (in0 >= 1) {
		DrawBox(mybox_Lx + move, 16, mybox_Rx + move, 20, GetColor(0, 0, 0), TRUE);
	}
}

int all_get_key() {

	char keys[256];
	int i;
	GetHitKeyStateAll(keys);

	for (i = 0; i < 256; i++) {
		if (keys[i] != 0) {
			key[i]++;
		}
		else {
			key[i] = 0;
		}
	}
	return 0;
}
